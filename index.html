<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>QR Scanner Î¼Îµ Î•Ï€Î¹Î»Î¿Î³Î­Ï‚</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f0f0f0; text-align: center; }
    h1 { color: #333; }
    #reader { width: 300px; margin: 20px auto; }
    #result { margin-top: 15px; font-weight: bold; color: #006400; }
    input[type="file"], button { margin-top: 10px; padding: 8px 12px; }
  </style>
</head>
<body>
  <h1>ğŸ“· QR Scanner Î¼Îµ Î•Ï€Î¹Î»Î¿Î³Î­Ï‚</h1>

  <h2>1ï¸âƒ£ Î£Î¬ÏÏ‰ÏƒÎ· Î¼Îµ ÎšÎ¬Î¼ÎµÏÎ±</h2>
  <div id="reader"></div>
  <button onclick="startCamera()">ÎÎµÎºÎ¯Î½Î± Î£Î¬ÏÏ‰ÏƒÎ·</button>
  <button onclick="stopCamera()">Î£Ï„Î±Î¼Î¬Ï„Î·ÏƒÎµ</button>

  <h2>2ï¸âƒ£ Î‘Î½Î­Î²Î±ÏƒÎµ Î•Î¹ÎºÏŒÎ½Î± QR</h2>
  <input type="file" id="imageInput" accept="image/*">
  <div id="result">ğŸ” Î ÎµÏÎ¹Î¼Î­Î½Ï‰ ÏƒÎ¬ÏÏ‰ÏƒÎ·...</div>

  <!-- html5-qrcode Î³Î¹Î± ÎºÎ¬Î¼ÎµÏÎ± -->
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>

  <!-- qr-scanner Î³Î¹Î± ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ -->
  <script type="module">
    import QrScanner from "https://unpkg.com/qr-scanner@1.4.2/qr-scanner.min.js";

    const imageInput = document.getElementById("imageInput");
    const resultElement = document.getElementById("result");

    imageInput.addEventListener("change", async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const result = await QrScanner.scanImage(file, { returnDetailedScanResult: true })
        .catch(() => null);

      if (result && result.data) {
        resultElement.textContent = "ğŸ“¦ Î‘Ï€ÏŒ ÎµÎ¹ÎºÏŒÎ½Î±: " + result.data;
      } else {
        resultElement.textContent = "âŒ Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ QR ÏƒÏ„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î±.";
      }
    });

    let html5QrCode;
    function startCamera() {
      html5QrCode = new Html5Qrcode("reader");
      Html5Qrcode.getCameras().then(devices => {
        if (devices && devices.length) {
          const cameraId = devices[0].id;
          html5QrCode.start(
            cameraId,
            { fps: 10, qrbox: 250 },
            qrCodeMessage => {
              resultElement.textContent = "ğŸ“¦ Î‘Ï€ÏŒ ÎºÎ¬Î¼ÎµÏÎ±: " + qrCodeMessage;
            },
            errorMessage => {
              console.warn("Î£Ï†Î¬Î»Î¼Î± ÏƒÎ¬ÏÏ‰ÏƒÎ·Ï‚: ", errorMessage);
            }
          ).catch(err => {
            console.error("Î£Ï†Î¬Î»Î¼Î± ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·Ï‚ ÎºÎ¬Î¼ÎµÏÎ±Ï‚: ", err);
            alert("âŒ Î”ÎµÎ½ Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„Î® Î· ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· Ï„Î·Ï‚ ÎºÎ¬Î¼ÎµÏÎ±Ï‚.");
          });
        } else {
          alert("âŒ Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· ÎºÎ¬Î¼ÎµÏÎ±.");
        }
      }).catch(err => {
        console.error("Î£Ï†Î¬Î»Î¼Î± Î»Î®ÏˆÎ·Ï‚ ÎºÎ±Î¼ÎµÏÏÎ½: ", err);
        alert("âŒ Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÎºÎ±Î¼ÎµÏÏÎ½.");
      });
    }

    function stopCamera() {
      if (html5QrCode) {
        html5QrCode.stop().then(() => {
          html5QrCode.clear();
          resultElement.textContent = "ğŸ›‘ Î— ÎºÎ¬Î¼ÎµÏÎ± ÏƒÏ„Î±Î¼Î¬Ï„Î·ÏƒÎµ.";
        }).catch(err => {
          console.error("Î£Ï†Î¬Î»Î¼Î± Î´Î¹Î±ÎºÎ¿Ï€Î®Ï‚ ÎºÎ¬Î¼ÎµÏÎ±Ï‚: ", err);
        });
      }
    }
  </script>
</body>
</html>
